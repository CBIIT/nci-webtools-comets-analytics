<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to COMETS (COnsortium of METabolomics Studies)</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.3.2/css/colReorder.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/css/selectize.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/css/selectize.bootstrap3.min.css" />
    <link rel="stylesheet" href="/common/css/style.css" />
    <link rel="stylesheet" href="css/comets.css" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/js/standalone/selectize.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/colreorder/1.3.2/js/dataTables.colReorder.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>

</head>

<body>
    <header>
        <a href="http://epi.grants.cancer.gov/comets/" target="_BLANK"><img src="images/COMETSLogo.png" alt="COMETS Analytics" title="Banner of COMETS Analytics" /></a>
    </header>
    <div class="container-fluid">
        <div id="pageContent">
            <div class="container-fluid">
                <div class="row">
                    <div id='page-head' class="col-xs-12"><b>CO</b>nsortium of <b>MET</b>abolomics <b>S</b>tudies</div>
                </div>
                <div class="row">
                    <nav class="navbar navbar-default">
                        <div class="collapse navbar-collapse" id="comets-tab-nav">
                            <ul class="nav nav-pills">
                                <li role="presentation" class="active"><a href="#tab-home" data-toggle="tab">Home</a></li>
                                <li role="presentation"><a href="#tab-correlate" data-toggle="tab" id="correlateTabId" data-toggle="tab">Correlate</a></li>
                                <li role="presentation"><a href="#tab-help" data-toggle="tab" id="helpTabId" data-toggle="tab">Help</a></li>
                                <li class="pull-right">
                                    <input type="button" class="btn btn-primary" id="logoutBtn" value="Logout" />
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <div class="tab-content">
                <div class="tab-pane active" id="tab-home">
                    <div class="container">
                        <div>
                            <img src="images/COMETSLogo.png" alt="COMETS Analytics" title="Banner of COMETS Analytics" />
                            <h3><strong>Welcome!</strong></h3>
                            <p>COMETS analytics is the self-service analytic platform for the <strong>C</strong>onsortium of <strong>MET</strong>abolomic <strong>S</strong>tudies. LOG IN using your facebook or google account by clicking on the logo or use your own account after creating your own account under SIGN UP.</p>
                            <p>The platform is maintained by the COMETS Harmonization group with web support from NCI <a href="http://cbiit.nci.nih.gov/">CBIIT</a>. For questions about COMETS analytics, please email <a href="mailto:cometsanalytics@gmail.com">cometsanalytics@gmail.com</a>.</p>
                            <p>For more information about the consortium, see the <a href="http://epi.grants.cancer.gov/comets/">COMETS website</a>.</p>
                        </div>
                    </div>
                </div>
                <!-- start correlate Tab -->
                <div class="tab-pane" id="tab-correlate">
                    <div class="row">
                        <div class="col-xs-12 col-md-4 col-lg-3">
                            <h3>Conduct cohort-specific correlation analyses</h3>
                            <form id="cometsForm" class="well clearfix" name="cometsForm" enctype="multipart/form-data">
                                <div class="row">
                                    <div id="messageDiv"></div>
                                </div>
                                <div class="form-group">
                                    <label for="inputDataFile">Choose Input Data File:<b>*</b></label>
                                    <div class="row">
                                        <input type="file" id="inputDataFile" name="inputDataFile" accept=".xls,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" class="col-xs-12 col-sm-7" required>
                                        <button id="load" class="btn btn-default pull-right" disabled="true">Check Integrity</button>
                                    </div>
                                    <div id="calcProgressbar" class="progress">
                                        <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                                            Uploading....please wait
                                        </div>
                                    </div>
                                </div>
                                <div id="analysisOptions">
                                    <div class="form-group">
                                        <label for="cohortSelection">Specify Cohort:<b>*</b></label>
                                        <select name="cohortSelection" id="cohortSelection" class="form-control" required>
                                            <option value=""> -- Select Cohort -- </option>
                                        </select>
                                    </div>
                                    <b>Specify Method Of Analyses:<b>*</b></b>
                                    <div class="radio">
                                        <label for="methodSelection1">
                                            <input type="radio" name="methodSelection" id="methodSelection1" value="Batch" checked="checked">Batch as specfied in the input file
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label for="methodSelection2">
                                            <input type="radio" name="methodSelection" id="methodSelection2" value="Interactive">Interactive user input
                                        </label>
                                    </div>
                                    <div id="Batch">
                                        <div class="form-group">
                                            <label for="modelSelection">Choose Model:<b>*</b></label>
                                            <select name="modelSelection" id="modelSelection" class="form-control" required></select>
                                        </div>
                                    </div>
                                    <div id="Interactive">
                                        <div class="form-group">
                                            <label for="modelDescription">Describe Model:*</label>
                                            <input type="text" name="modelDescription" id="modelDescription" class="form-control" required />
                                        </div>
                                        <div class="form-group checkbox">
                                            <label for="showMetabolites">
                                                <input type="checkbox" name="showMetabolites" id="showMetabolites">Show individual metabolites<br>
                                                    <em><small>* Note: This option applies to Exposures, Outcomes and Adjusted Covariates</small></em>
                                                
                                            </label>
                                        </div>
                                        <div class="form-group">
                                            <label for="exposure">Select Exposure(s):<b>*</b></label>
                                            <input type="text" name="exposure" id="exposure" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="outcome">Select Outcome(s):<b>*</b></label>
                                            <input type="text" name="outcome" id="outcome" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="covariates">Adjusted Covariates:</label>
                                            <input type="text" name="covariates" id="covariates" />
                                        </div>
                                    </div>
                                    <button id="runModel" class="btn btn-default pull-right" disabled="true">Run Model</button>
                                </div>
                                <a id="toggleHelp" href="javascript:void(0);">Help</a>
                                <br/><a id="sampleDownload" href="examples/cometsInput.xlsx">Download Sample Input File</a>
                                <div id="inputHelp">
                                    <h4>Input fields</h4> Specify the name of your cohort. If your cohort is not listed, please notify the harmonization group.

                                    <h4>Integrity check</h4> The tab will display the results of the harmonization and integrity check results.

                                    <h4>Summary</h4> The table of correlations and metabolite information is displayed with an option to download the results in CSV format. For each exposure, the correlation, n and p value are displayed. Please download the file for each model and send to data harmonization group.


                                    <h4>Heatmap</h4> The heatmap displays the metabolites in rows and exposures in columns using partial (if adjustment variables are specified) spearman correlations. From this tab, you can download the heatmap as a png file, pan, zoom and get correlation coefficients. You can also sort the results using the dropdown menu.

                                    <h4>Cluster and heatmap</h4> The cluster and heatmap is available for use when there are 2 or more exposures and 2 or more outcomes are specified.


                                    <h4>Network</h4> Using the genenet package, we display the partial correlation network of your outcomes, exposures and adjusted covariates. There is an option to display the minimum correlation to display with a default of 0.40.

                                </div>
                            </form>
                        </div>
                        <!-- end of well -->

                        <div class="col-xs-12 col-md-8 col-lg-9">
                            <div class="row">
                                <div class="col-md-12">
                                    <!-- Collect the nav links, forms, and other content for toggling -->
                                    <ul class="nav nav-tabs responsive">
                                        <li class="active"><a href="#tab-integrity" data-toggle="tab">Integrity Check</a></li>
                                        <li><a href="#tab-summary" data-toggle="tab">Correlation Results</a></li>
                                        <li><a href="#tab-heatmap" data-toggle="tab">Heatmap</a></li>
                                    </ul>
                                    <div id="result-tab-content" class="tab-content tab-border">
                                        <div class="tab-pane active" id="tab-integrity"></div>
                                        <div class="tab-pane" id="tab-summary"></div>
                                        <div class="tab-pane" id="tab-heatmap"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- end of row -->
                        </div>
                    </div>
                    <!-- end of right panel -->
                </div>
                <!-- start help Tab -->
                <div class="tab-pane" id="tab-help">
                    <div id="toc" style="float:left;">
                        <div><a href="#about" class="goto">About</a></div>
                        <div><a href="#flowchart" class="goto">Flowchart</a></div>
                    </div>
                    <div id="about"></div>
                    <div id="flowchart" class="container">
                        <span>Steps in the COMETS analysis process are outlined below.</span>
                        <img class="img-repsonsive" src="images/cometsWorkflow.png" alt="diagram of the workflow for the comets application" />
                        <div class="row">
                            <h3 class="col-xs-12 col-md-1 steps">Step 1</h3>
                            <div class="col-xs-12 col-md-10">
                                <h3>Upload input file</h3>
                                <p>The input file is currently in excel formate with 5 sheets. Download and use the <a href="cometsInput.xlsx" title="example input excel file">example input file here</a> as a template.</p>
                                <ol>
                                    <li> <b><i>Metabolites</i></b>
                                        <br>This sheet serves as the metadata or information on the metabolites used for the harmonization step. Minimum required columns include analysis platform, metabolite name and metabolite id (ie. variable name of your metabolite). It is preferred to also include RT, m/z, chemical ID (HMDB, InChi key, or other identifier).
                                    </li>
                                    <li> <b><i>SubjectMetabolites</i></b>
                                        <br> This sheet contains the abundances in columns and subject in rows. The subject identifier is expected in the first column and the remaining columns are considered as metabolite ids.
                                    </li>
                                    <li> <b><i>SubjectData</i></b>
                                        <br> This sheet contains other exposure and adjustment variables for use in the analyses.
                                    </li>
                                    <li> <b><i>VarMap</i></b>
                                        <br>This sheet is used to map the variables needed to conduct the cohort specific analysis. Specify the name of variables under CohortVariable column and add notes for your convenience. Cells in grey are protected. You will also need to specify the column name in the metabolites sheet corresponding to your metabolite_id.
                                    </li>
                                    <li> <b><i>Models</i></b>
                                        <br> This sheet is used for the batch analyses mode and contains the model specifications. Outcomes, exposures and adjustment can specify multiple covariates delimited by spaces (ie: age bmi).
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="row">
                            <h3 class="col-xs-12 col-md-1 steps">Step 2</h3>
                            <div class="col-xs-12 col-md-10">
                                <h3>Harmonize Metabolites</h3>
                                <p>
                                    The harmonization step will assess whether your cohort’s metabolites are available in COMET’s master metabolites so that a universal ID (named UID_01) can be associated with your metabolites. The COMETS master metabolite list is maintained by IMS and can be sent in advance of the analyses to ensure availability of a universal ID for each of your metabolites. The universal ID (currently named UID_01) ensures alignment of metabolites across the different cohorts to ensure identification for meta-analysis.</p>
                            </div>
                        </div>
                        <div class="row">
                            <h3 class="col-xs-12 col-md-1 steps">Step 3</h3>
                            <div class="col-xs-12 col-md-10">
                                <h3>Data Integrity</h3>
                                <p>
                                    Data integrity checks are run to ensure the appropriate data are presented for analyses. The following conditions are checked:
                                    <ol>
                                        <li> Subject ID or Metabolite ID is/are not provided in the Varmap sheet
                                        </li>
                                        <li> Subject ID or Metabolite ID provided in Varmap sheet do not correspond to a column in “Metabolites” and “SubjectData” sheets, respectively
                                        </li>
                                        <li> Metabolites ids in Metabolites and SubjectMetabolites sheet do not match
                                        </li>
                                        <li> Subject ids in SubjectData and SubjectMetabolites sheet do not match
                                        </li>
                                    </ol>
                                    If any of the following conditions failed, the analyses will be suspended and corrections to the data are required. The data integrity checks will also flag the following but will proceed with the analyses:
                                    <ol>
                                        <li> Number of subjects in “SubjectData” and “SubjectMetabolites” sheets do not match
                                        </li>
                                        <li> Metabolite abundances from “SubjectMetabolites” contains duplicate columns (metabolites) or rows (subjects)
                                        </li>
                                        <li> There are duplicate subject ids in Subject Information “SubjectData” sheet
                                        </li>
                                        <li> There are duplicate metabolite ids in Metabolite Information “Metabolites” sheet
                                        </li>
                                    </ol>
                                </p>
                            </div>
                        </div>
                        <div class="row">
                            <h3 class="col-xs-12 col-md-1 steps">Step 4</h3>
                            <div class="col-xs-12 col-md-10">
                                <h3>Run Correlation Analyses</h3>
                                <p>
                                    The correlation analyses can be done in batch (as specified in the input file) or in interactive mode using user specified exposure and outcome variables. Heatmaps and hierarchical clustering of the computed Spearman correlations are also available.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end of help tab content -->
            </div>
            <!-- end of correlate Tab -->
        </div>
        <footer class="footer">
            <div class="center-block">
                <ul class="list-inline">
                    <li><a href="http://www.cancer.gov/" title="cancer.gov Home" target="_blank">Home</a></li>
                    <li>|</li>
                    <li><a href="mailto:cometsanalytics@gmail.com" title="Support" target="_top">Support</a></li>
                    <li>|</li>
                    <li><a href="http://www.cancer.gov/global/web/policies" title="Policies" target="_blank">Policies</a></li>
                    <li>|</li>
                    <li><a href="http://www.cancer.gov/global/web/policies/accessibility" title="Accessibility" target="_blank">Accessibility</a></li>
                    <li>|</li>
                    <li><a href="http://cancer.gov/global/viewing-files" title="Viewing Files" target="_blank">Viewing Files</a></li>
                    <li>|</li>
                    <li><a href="http://www.cancer.gov/global/web/policies/foia" title="Freedom of Information Act" target="_blank">FOIA</a></li>
                </ul>
                <ul class="list-inline">
                    <li><a href="http://www.hhs.gov/" target="_blank">U.S. Department of Health and Human Services</a></li>
                    <li>|</li>
                    <li><a href="http://www.nih.gov" target="_blank">National Institutes of Health</a></li>
                    <li>|</li>
                    <li><a href="http://www.cancer.gov/" target="_blank">National Cancer Institute</a></li>
                    <li>|</li>
                    <li><a href="http://usa.gov" target="_blank">USA.gov</a></li>
                </ul>
                <div class="text-center">NIH ... Turning Discovery Into Health<sup>®</sup></div>
            </div>
        </footer>
        <div id="loader"><img src="images/loader.gif" alt="Loading....Please Wait"></div>
    </div>
    <!-- end of container -->
    <script type="text/javascript" src="javascript/appViews.js"></script>
    <script type="text/javascript" src="javascript/appModels.js"></script>
    <script type="text/javascript" src="javascript/comets.js"></script>
</body>

</html>
